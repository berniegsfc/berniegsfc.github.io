<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.4 on Fri Aug  1 08:37:22 2025 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>spdfsscwsexample2.pro (Complete SSC R2.4.14 Web Services API)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="spdfsscwsexample2.pro (Complete SSC R2.4.14 Web Services API)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;</span>
<span class="comments">; NOSA HEADER START</span>
<span class="comments">;</span>
<span class="comments">; The contents of this file are subject to the terms of the NASA Open </span>
<span class="comments">; Source Agreement (NOSA), Version 1.3 only (the "Agreement").  You may </span>
<span class="comments">; not use this file except in compliance with the Agreement.</span>
<span class="comments">;</span>
<span class="comments">; You can obtain a copy of the agreement at</span>
<span class="comments">;   docs/NASA_Open_Source_Agreement_1.3.txt</span>
<span class="comments">; or </span>
<span class="comments">;   https://sscweb.gsfc.nasa.gov/WebServices/NASA_Open_Source_Agreement_1.3.txt.</span>
<span class="comments">;</span>
<span class="comments">; See the Agreement for the specific language governing permissions</span>
<span class="comments">; and limitations under the Agreement.</span>
<span class="comments">;</span>
<span class="comments">; When distributing Covered Code, include this NOSA HEADER in each</span>
<span class="comments">; file and include the Agreement file at </span>
<span class="comments">; docs/NASA_Open_Source_Agreement_1.3.txt.  If applicable, add the </span>
<span class="comments">; following below this NOSA HEADER, with the fields enclosed by </span>
<span class="comments">; brackets "[]" replaced with your own identifying information: </span>
<span class="comments">; Portions Copyright [yyyy] [name of copyright owner]</span>
<span class="comments">;</span>
<span class="comments">; NOSA HEADER END</span>
<span class="comments">;</span>
<span class="comments">; Copyright (c) 2017 United States Government as represented by </span>
<span class="comments">; the National Aeronautics and Space Administration. No copyright is </span>
<span class="comments">; claimed in the United States under Title 17, U.S.Code. All Other </span>
<span class="comments">; Rights Reserved.</span>
<span class="comments">;</span>
<span class="comments">;</span>


<span class="comments">;+</span>
<span class="comments">; This program is an example to demonstrate calling the</span>
<span class="comments">; &lt;a href="https://sscweb.gsfc.nasa.gov/">Satellite Situation Center's&lt;/a></span>
<span class="comments">; &lt;a href="https://sscweb.gsfc.nasa.gov/WebServices/REST/"></span>
<span class="comments">; REST Web Services&lt;/a> from an </span>
<span class="comments">; &lt;a href="http://www.harrisgeospatial.com/">Exelis Visual Information </span>
<span class="comments">; Solutions&lt;/a></span>
<span class="comments">; (VIS) Interactive Data Language (IDL) program.  It demonstrates the </span>
<span class="comments">; following:</span>
<span class="comments">;   &lt;ul></span>
<span class="comments">;     &lt;li>Using a JSON representation for the request and response </span>
<span class="comments">;         entity body.&lt;/li></span>
<span class="comments">;     &lt;li>Requesting the magnetic conjunction of a set of satellites.&lt;/li></span>
<span class="comments">;   &lt;/ul></span>
<span class="comments">;</span>
<span class="comments">; @copyright Copyright (c) 2017 United States Government as </span>
<span class="comments">;     represented by the National Aeronautics and Space Administration.</span>
<span class="comments">;     No copyright is claimed in the United States under Title 17,</span>
<span class="comments">;     U.S.Code. All Other Rights Reserved.</span>
<span class="comments">;</span>
<span class="comments">; @author B. Harris</span>
<span class="comments">;-</span>




<span class="comments">;+</span>
<span class="comments">; This procedure is an example to demonstrate calling the SSC REST</span>
<span class="comments">; Web Services from an IDL program.  It demonstrates the following:</span>
<span class="comments">;   &lt;ul></span>
<span class="comments">;     &lt;li>Using a JSON representation for the request and response </span>
<span class="comments">;         entity body.&lt;/li></span>
<span class="comments">;     &lt;li>Requesting the magnetic conjunction of a set of satellites.&lt;/li></span>
<span class="comments">;   &lt;/ul></span>
<span class="comments">; @requires 8.2</span>
<span class="comments">;-</span>
<a id="SpdfSscWsExample2:source"></a>pro SpdfSscWsExample2
    compile_opt idl2

    conjunctionReq = '{' + $
        '"Request": {' + $
            '"BfieldModel": {' + $
                '"ExternalBFieldModel": {' + $
                    '"@class": "gov.nasa.gsfc.sscweb.schema.Tsyganenko89CBFieldModel",' + $
                    '"KeyParameterValues": "KP_3_3_3"' + $
                '},' + $
                '"InternalBFieldModel": "IGRF",' + $
                '"TraceStopAltitude": 1' + $
            '},' + $
            '"ConditionOperator": "ALL",' + $
            '"Conditions": [' + $
                '"java.util.ArrayList",' + $
                '[' + $
                    '{' + $
                        '"@class": "gov.nasa.gsfc.sscweb.schema.SatelliteCondition",' + $
                        '"Satellite": [' + $
                            '"java.util.ArrayList",' + $
                            '[' + $
                                '{' + $
                                    '"BfieldTraceDirection": "SOUTH_HEMISPHERE",' + $
                                    '"Id": "barrel1a"' + $
                                '},' + $
                                '{' + $
                                    '"BfieldTraceDirection": "SOUTH_HEMISPHERE",' + $
                                    '"Id": "rbspa"' + $
                                '},' + $
                                '{' + $
                                    '"BfieldTraceDirection": "SOUTH_HEMISPHERE",' + $
                                    '"Id": "rbspb"' + $
                                '}' + $
                            ']' + $
                        '],' + $
                        '"SatelliteCombination": 1' + $
                    '},' + $
                    '{' + $
                        '"@class": "gov.nasa.gsfc.sscweb.schema.LeadSatelliteCondition",' + $
                        '"ConjunctionArea": {' + $
                            '"@class": "gov.nasa.gsfc.sscweb.schema.BoxConjunctionArea",' + $
                            '"CoordinateSystem": "GEO",' + $
                            '"DeltaLatitude": 3.0,' + $
                            '"DeltaLongitude": 10.0' + $
                        '},' + $
                        '"Satellite": [' + $
                            '"java.util.ArrayList",' + $
                            '[' + $
                                '{' + $
                                    '"BfieldTraceDirection": "SOUTH_HEMISPHERE",' + $
                                    '"Id": "barrel1a"' + $
                                '}' + $
                            ']' + $
                        '],' + $
                        '"TraceType": "B_FIELD"' + $
                    '}' + $
                ']' + $
            '],' + $
            '"Description": "Magnetic conjunction of at least 1 RBSP satellites with BARREL 1A (lead satellite).",' + $
            '"ExecuteOptions": {' + $
                '"ResultEmailAddress": null,' + $
                '"WaitForResult": true' + $
            '},' + $
            '"ResultOptions": {' + $
                '"FormatOptions": {' + $
                    '"Cdf": null,' + $
                    '"DateFormat": "YYYY_DDD",' + $
                    '"DegreeDigits": 2,' + $
                    '"DegreeFormat": "DECIMAL",' + $
                    '"DistanceDigits": 1,' + $
                    '"DistanceFormat": "INTEGER_KM",' + $
                    '"LatLonFormat": "LAT_90_LON_360",' + $
                    '"LinesPerPage": 55,' + $
                    '"TimeFormat": "HH_HHHH"' + $
                '},' + $
                '"IncludeQueryInResult": true,' + $
                '"QueryResultType": "XML",' + $
                '"SubSatelliteCoordinateSystem": "GEO",' + $
                '"SubSatelliteCoordinateSystemType": "SPHERICAL",' + $
                '"TraceCoordinateSystem": "GEO"' + $
            '},' + $
            '"TimeInterval": {' + $
                '"End": [' + $
                    '"javax.xml.datatype.XMLGregorianCalendar",' + $
                    '"2013-02-14T00:00:00.000+0000"' + $
                '],' + $
                '"Start": [' + $
                    '"javax.xml.datatype.XMLGregorianCalendar",' + $
                    '"2013-01-29T00:00:00.000+0000"' + $
                ']' + $
            '}' + $
        '}' + $
    '}'

<span class="comments">;    openw, 3, 'conjunction.json'</span>
<span class="comments">;    printf, 3, conjunctionReq</span>
<span class="comments">;    close, 3</span>
<span class="comments">;    json = json_parse(conjunctionReq)</span>
<span class="comments">;    help, json</span>

    catch, errorStatus
    if (errorStatus ne 0) then begin

        catch, /cancel

        requestUrl->GetProperty, RESPONSE_CODE=rspCode, $
             RESPONSE_HEADER=rspHdr, RESPONSE_FILENAME=rspFn

        PRINT, 'rspCode = ', rspCode
        PRINT, 'rspHdr= ', rspHdr
        PRINT, 'rspFn= ', rspFn

        obj_destroy, requestUrl

    endif


    userAgent = 'User-Agent: SpdfSscWsExample2 (' + $
        !version.os + ' ' + !version.arch + ') IDL/' + !version.release

    sscUrl = 'http://sscweb-dev.sci.gsfc.nasa.gov/WS/sscr/2/conjunctions'
    urlComponents = parse_url(sscUrl)

    headers = [userAgent, $
               'Content-Type: application/json', $
               'Accept: application/json']
<span class="comments">;    headers = 'Content-Type: application/json'</span>

    requestUrl = obj_new('IDLnetURL')
    requestUrl->setProperty, $
        headers=headers, $
        url_scheme=urlComponents.scheme, $
        url_host=urlComponents.host, $
        url_port=urlComponents.port, $
        url_path=urlComponents.path
    
    result = requestUrl->put(conjunctionReq, /buffer, /post, url=sscUrl)

<span class="comments">;    print, result</span>
<span class="comments">;    result = '/home/btharris/Projects/Spdf/sscWebServices/src/idl/PutRsp.dat'</span>

<span class="comments">;    spawn, 'python -mjson.tool ' + result, prettyResult</span>
<span class="comments">;    print, prettyResult</span>

    conjunctionRes = json_parse(result)

    queryResult = conjunctionRes['QueryResult']
<span class="comments">;    print, queryResult</span>

    status = queryResult['StatusCode']
    print, status
    queryRequest = queryResult['QueryRequest']
    queryDescription = queryRequest['Description']
    print, queryDescription

    conjunctions = (queryResult['Conjunction'])[1]
<span class="comments">;    print,  conjunctions</span>
    print, 'Conjunctions:'
    for i = 0, n_elements(conjunctions) - 1 do begin

        print, format='(%"%d")',i
        conjunction = conjunctions[i]
<span class="comments">;        print, conjunction</span>
        timeInterval = conjunction['TimeInterval']
        startTime = (timeInterval['Start'])[1]
        endTime = (timeInterval['End'])[1]
        print, '    ', startTime, ' - ', endTime

        satDescriptions = conjunction['SatelliteDescription']
        for j = 0, n_elements(satDescriptions) - 1 do begin

        satDescription = (conjunction['SatelliteDescription'])[1,j]
<span class="comments">;        print, satDescription</span>
        sat = (satDescription['Satellite'])
        print, '    ', sat, '     Latitude        Longitude        Radius'
        description = (satDescription['Description'])[1,0]
        location = description['Location']
        lat = location['Latitude']
        lon = location['Longitude']
        radius = location['Radius']
        print, '        ', lat, lon, radius
        traceDescription = description['TraceDescription']
        arcLength = traceDescription['ArcLength']
        traceLoc = traceDescription['Location']
        traceLat = traceLoc['Latitude']
        traceLon = traceLoc['Longitude']
        traceTarget = traceDescription['Target']
        targetDistance = traceTarget['Distance']
        targetLeadSatellite = traceTarget['LeadSatellite']
        print, '        Trace: ArcLength      Latitude        Longitude'
        print, '        ', arcLength, traceLat, traceLon
        print, '        Target: Distance  LeadSatellite'
        print, '        ', targetDistance, '  ', targetLeadSatellite
        endfor
    endfor

    obj_destroy, requestUrl
end

</code>
    </div>
  </body>
</html>